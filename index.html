<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Elite Academy Profile</title>

<style>
:root{
  --bg:#0b0d10;
  --panel:#0f1217;
  --panel2:#111621;
  --ink:#ffffff;
  --muted:rgba(255,255,255,.62);
  --line:rgba(255,255,255,.10);
  --soft:rgba(255,255,255,.06);
  --accent:#ffffff; /* keep neutral elite */
  --radius:26px;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  background:
    radial-gradient(900px 500px at 15% 0%, rgba(255,255,255,.08), transparent 55%),
    radial-gradient(900px 500px at 85% 0%, rgba(255,255,255,.06), transparent 55%),
    var(--bg);
  color:var(--ink);
  -webkit-font-smoothing:antialiased;
}

.top{
  position:sticky;top:0;z-index:10;
  backdrop-filter: blur(14px);
  background: rgba(11,13,16,.72);
  border-bottom:1px solid var(--line);
}

.topInner{
  max-width:1200px;margin:0 auto;
  padding:16px 20px;
  display:flex;align-items:center;justify-content:space-between;
  gap:14px;flex-wrap:wrap;
}

.kicker{
  font-size:11px;
  font-weight:900;
  letter-spacing:1.6px;
  text-transform:uppercase;
  opacity:.95;
}

.subkicker{
  margin-top:6px;
  font-size:12px;
  color:var(--muted);
  font-weight:650;
}

.pill{
  display:flex;gap:10px;align-items:center;
  padding:10px 12px;
  border:1px solid var(--line);
  border-radius:999px;
  background:rgba(255,255,255,.04);
  color:var(--muted);
  font-size:12px;
  font-weight:700;
  white-space:nowrap;
}

.page{
  max-width:1200px;
  margin:0 auto;
  padding:34px 20px 80px;
}

.hero{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap:18px;
  flex-wrap:wrap;
  margin-bottom:22px;
}

.name{
  font-size:58px;
  font-weight:950;
  letter-spacing:-2.8px;
  line-height:.92;
}

.metaLine{
  margin-top:12px;
  font-size:13px;
  color:var(--muted);
  font-weight:650;
}

.teamTag{
  padding:10px 14px;
  border-radius:999px;
  border:1px solid var(--line);
  background:rgba(255,255,255,.04);
  font-size:12px;
  font-weight:900;
  letter-spacing:1px;
  text-transform:uppercase;
}

.layout{
  display:grid;
  grid-template-columns:1.25fr .75fr;
  gap:18px;
}

@media(max-width:980px){
  .layout{grid-template-columns:1fr}
  .name{font-size:42px}
}

.card{
  border:1px solid var(--line);
  border-radius:var(--radius);
  background:rgba(255,255,255,.03);
  padding:20px;
}

.cardStrong{
  background:
    linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
}

.sectionTitle{
  font-size:11px;
  font-weight:900;
  letter-spacing:1.4px;
  text-transform:uppercase;
  color:var(--muted);
}

.big{
  margin-top:14px;
  font-size:34px;
  font-weight:950;
  letter-spacing:-1.8px;
  line-height:1.05;
}

.sub{
  margin-top:10px;
  font-size:13px;
  color:var(--muted);
  font-weight:650;
}

.grid2{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
  margin-top:12px;
}

.stat{
  background:rgba(255,255,255,.04);
  border:1px solid var(--line);
  border-radius:22px;
  padding:16px;
}

.statLabel{
  font-size:11px;
  color:var(--muted);
  font-weight:750;
  letter-spacing:1px;
  text-transform:uppercase;
}

.statValue{
  margin-top:10px;
  font-size:22px;
  font-weight:950;
  letter-spacing:-1px;
}

.rightCol{
  display:flex;
  flex-direction:column;
  gap:12px;
}

.avatarWrap{
  width:132px;height:132px;
  border-radius:32px;
  overflow:hidden;
  border:1px solid var(--line);
  background:rgba(255,255,255,.05);
}

.avatar{
  width:100%;height:100%;
  object-fit:cover;
  display:block;
  background:#1a1f28;
}

.actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

button{
  border:none;
  border-radius:999px;
  padding:12px 16px;
  font-weight:900;
  letter-spacing:.6px;
  text-transform:uppercase;
  font-size:12px;
  cursor:pointer;
  transition:transform .12s ease, opacity .2s ease;
}

button:hover{transform:translateY(-1px)}
.primary{
  background:#fff;color:#000;
}
.ghost{
  background:transparent;
  border:1px solid var(--line);
  color:#fff;
}
select{
  width:100%;
  padding:12px 14px;
  border-radius:999px;
  border:1px solid var(--line);
  background:rgba(255,255,255,.04);
  color:#fff;
  font-weight:850;
  outline:none;
}
select:focus{box-shadow:0 0 0 4px rgba(255,255,255,.08)}

.hr{
  height:1px;background:var(--line);margin:14px 0;
}

.toast{
  position:fixed;
  bottom:18px;left:50%;
  transform:translateX(-50%);
  background:#fff;color:#000;
  padding:10px 14px;
  border-radius:999px;
  font-weight:850;
  display:none;
}
</style>
</head>

<body>

<div class="top">
  <div class="topInner">
    <div>
      <div class="kicker" id="roleText">—</div>
      <div class="subkicker" id="clubText">—</div>
    </div>
    <div class="pill">
      <span id="today">—</span>
    </div>
  </div>
</div>

<div class="page">
  <div class="hero">
    <div>
      <div class="name" id="athleteName">LOADING</div>
      <div class="metaLine" id="playerIdLine"></div>
    </div>
    <div class="teamTag" id="teamName">—</div>
  </div>

  <div class="layout">
    <div>
      <div class="card cardStrong">
        <div class="sectionTitle">Next Event</div>
        <div class="big" id="eventType">—</div>
        <div class="sub" id="eventDetails"></div>

        <div class="grid2">
          <div class="stat">
            <div class="statLabel">Jersey</div>
            <div class="statValue" id="jersey">—</div>
          </div>
          <div class="stat">
            <div class="statLabel">DOB</div>
            <div class="statValue" id="dob">—</div>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:12px;">
        <div class="sectionTitle">Alert</div>
        <div class="big" id="alertTitle" style="font-size:22px;margin-top:12px;">—</div>
        <div class="sub" id="alertMsg"></div>
      </div>

      <div class="card" style="margin-top:12px;">
        <div class="sectionTitle">Parent Contact</div>
        <div class="sub" id="parentEmail" style="margin-top:12px;">Email: —</div>
        <div class="sub" id="parentPhone">Phone: —</div>
      </div>
    </div>

    <div class="rightCol">
      <div class="card">
        <div class="sectionTitle">Profile</div>
        <div style="display:flex;gap:14px;align-items:center;margin-top:14px;">
          <div class="avatarWrap">
            <img id="avatar" class="avatar" alt="Athlete"/>
          </div>
          <div style="flex:1;">
            <div class="sub" style="margin:0;color:var(--muted);">Elite Academy Profile</div>
            <div class="hr"></div>
            <div class="actions">
              <button class="primary" id="viewIdpBtn">View IDP</button>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="sectionTitle">Switch Athlete</div>
        <div class="sub" style="margin-top:10px;">Parents can change between linked athletes.</div>
        <div style="margin-top:14px;">
          <select id="kidSelect" style="display:none;"></select>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
let state = null;

function post(type, payload = {}) {
  window.parent.postMessage({ type, payload }, "*");
}

function toast(msg){
  const t = document.getElementById("toast");
  t.textContent = msg || "";
  t.style.display = msg ? "block" : "none";
  clearTimeout(window.__toastTimer);
  if(msg) window.__toastTimer = setTimeout(()=>t.style.display="none", 1800);
}

function setText(id, v){
  const el = document.getElementById(id);
  if(el) el.textContent = v ?? "";
}

function render(){
  if(!state) return;

  const p = state.player || {};
  const fullName = `${p.firstName||""} ${p.lastName||""}`.trim() || "Athlete";

  setText("athleteName", fullName.toUpperCase());
  setText("playerIdLine", p.id ? `Player ID: ${p.id}` : "");

  setText("roleText", state.role ? `ROLE: ${state.role}` : "—");
  setText("clubText", state.clubSlug ? `CLUB: ${state.clubSlug}` : "—");
  setText("today", state.today || "—");

  setText("teamName", state.team?.name ? state.team.name : "—");

  setText("jersey", p.jerseyNumber ? `#${p.jerseyNumber}` : "—");
  setText("dob", p.dob || "—");

  document.getElementById("avatar").src = p.photoUrl || "";

  const evt = state.nextEvent;
  if(!evt){
    setText("eventType", "NO UPCOMING EVENT");
    setText("eventDetails", "");
  } else {
    setText("eventType", (evt.type || "").toUpperCase());
    const opp = evt.opponent ? `vs ${evt.opponent}` : "";
    const when = `${evt.date || ""}${evt.time ? " • " + evt.time : ""}`.trim();
    const where = evt.location ? ` • ${evt.location}` : "";
    setText("eventDetails", `${opp}${opp && when ? " • " : ""}${when}${where}`.trim());
  }

  setText("alertTitle", state.alert?.title || "NO ACTIVE ALERTS");
  setText("alertMsg", state.alert?.message || "");

  setText("parentEmail", state.parent?.email ? `Email: ${state.parent.email}` : "Email: —");
  setText("parentPhone", state.parent?.phone ? `Phone: ${state.parent.phone}` : "Phone: —");

  const kids = state.kids || [];
  const sel = document.getElementById("kidSelect");
  if(state.role === "Parent" && kids.length > 0){
    sel.style.display = "block";
    sel.innerHTML = kids.map(k=>{
      const selected = (k.id === state.activePlayerId) ? "selected" : "";
      return `<option value="${k.id}" ${selected}>${k.name}</option>`;
    }).join("");
  } else {
    sel.style.display = "none";
  }
}

window.addEventListener("message", (event) => {
  const msg = event.data || {};
  if(msg.type === "STATE"){
    state = msg.payload;
    render();
  }
  if(msg.type === "TOAST"){
    toast(msg.payload?.message || "");
  }
});

document.getElementById("viewIdpBtn").addEventListener("click", () => {
  post("VIEW_IDP", {});
});

document.getElementById("kidSelect").addEventListener("change", (e) => {
  post("SELECT_KID", { playerId: e.target.value });
});

function readyPing(){
  post("IFRAME_READY", {});
}

window.addEventListener("load", () => {
  readyPing();
  setTimeout(readyPing, 600);
  setTimeout(readyPing, 1500);
});
readyPing();
</script>

</body>
</html>
